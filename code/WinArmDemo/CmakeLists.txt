cmake_minimum_required(VERSION 3.10)

set(PROJECT_NAME WinArmDemo)

set(CONFIG_DIR ${CMAKE_CURRENT_SOURCE_DIR}/../../build/${PROJECT_NAME})

set(PROJECT_OUTPUT_DIR ${CMAKE_CURRENT_SOURCE_DIR}/../../build/${PROJECT_NAME}/output)


project(
    ${PROJECT_NAME}
    VERSION 1.0
    DESCRIPTION "A simple Hello World project"
    LANGUAGES C ASM)

set(PROJECT_SOURCE "")
set(PROJECT_INCLUDE_DIRS "")

add_subdirectory(DemoSubFolder)

add_executable(${PROJECT_NAME} test.c)

target_link_libraries(${PROJECT_NAME} PRIVATE DemoSubFolder)

target_include_directories(
    ${PROJECT_NAME}
    PRIVATE
    ${PROJECT_INCLUDE_DIRS})

target_link_libraries(
    ${PROJECT_NAME}
    PRIVATE
    )

target_compile_options(
    ${PROJECT_NAME}
    PUBLIC
    -nostdlib
    )

target_link_options(
    ${PROJECT_NAME}
    PUBLIC
    -nostdlib
    -nostartfiles)

if(EXISTS "${CONFIG_DIR}/Compilation.txt")
    file(READ "${CONFIG_DIR}/Compilation.txt" USER_CFLAGS)
    target_compile_definitions(
        ${PROJECT_NAME}
        PUBLIC
        ${USER_CFLAGS})
endif()

if(EXISTS "${CONFIG_DIR}/Link.txt")
    file(READ "${CONFIG_DIR}/Link.txt" USER_LFLAGS)
    target_link_libraries(
        ${PROJECT_NAME}
        PUBLIC
        ${USER_LFLAGS})
endif()

set_target_properties(${PROJECT_NAME} PROPERTIES RUNTIME_OUTPUT_DIRECTORY ${PROJECT_OUTPUT_DIR})

